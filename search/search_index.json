{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Tetra Connect Documentation","text":"<p>Tetra Connect is a cloud-native identity resolution platform for matching person records within your data. Built for real-time searching, it uses intelligent fuzzy search and multi-algorithm scoring to provide high-accuracy matches even when data contains errors, variations, or inconsistencies.</p> <p> Learn more about Tetra Connect</p>"},{"location":"#getting-started","title":"Getting Started","text":"<ol> <li>Understand the System Overview and architecture</li> <li>Deploy to your environment following the Deployment Guide</li> <li>Integrate the APIs into your applications via the Integration Guide</li> <li>Load your first dataset with the Data Ingestion Guide</li> <li>Search and validate results using the Search Guide or User Interface</li> <li>Tune matching behaviour as described in the Search Guide</li> </ol>"},{"location":"#documentation-by-role","title":"Documentation by Role","text":"<ul> <li> <p> Platform Engineers</p> <p>Deploy and operate Tetra Connect in your environment</p> <p> Deployment Guide</p> </li> <li> <p> Application Developers</p> <p>Integrate Tetra Connect APIs into your applications</p> <p> Integration Guide</p> </li> <li> <p> System Architects</p> <p>Understand search behaviour and tune matching configuration</p> <p> Search Guide</p> </li> <li> <p> Data Engineers</p> <p>Ingest and synchronise data from your sources</p> <p> Data Ingestion</p> </li> </ul>"},{"location":"#support","title":"Support","text":"<p>For technical support or questions:</p> <ul> <li>Email: support@tetratechnology.co.uk</li> </ul>"},{"location":"overview/","title":"System Overview","text":"<p>Tetra Connect is a self-hosted identity resolution system delivered as containerised microservices. It provides REST APIs for fuzzy matching person records using configurable search strategies and multi-algorithm scoring.</p> <p>Key Characteristics:</p> <ul> <li>Microservices Architecture: Four independent services (Search, Score, Ingestion, UI) deployed and scaled separately</li> <li>Horizontally Scalable: Horizontally scale to meet your demand. Searches millions of records in sub-seconds</li> <li>Configurable Matching: Tune fuzzy search algorithms, scoring thresholds, and matching behaviour without code changes</li> <li>Shared Storage Design: NFS/EFS-based architecture enables separation between data ingestion and search execution</li> <li>Production-Ready: Built-in observability (Prometheus, Zipkin), health checks, and isolated deployment per data source</li> </ul>"},{"location":"overview/#system-architecture","title":"System Architecture","text":""},{"location":"overview/#services","title":"Services","text":"<p>Tetra Connect consists of four microservices:</p> Service Purpose Search Service Executes fuzzy search queries and returns ranked, scored results Ingestion Service Loads data from data sources and builds searchable indexes UI Web interface for ad-hoc searches, configuration validation, and testing workflows Score Service Scoring engine called by Search Service to rank results"},{"location":"overview/#architecture-diagram","title":"Architecture Diagram","text":"<pre><code>graph TB\n    Client[Client Application]\n\n    subgraph \"Tetra Connect\"\n        Search[Search Service&lt;br/&gt;Port 1967&lt;br/&gt;External]\n        Score[Score Service&lt;br/&gt;Port 1969&lt;br/&gt;Internal]\n        Ingest[Ingestion Service&lt;br/&gt;Port 1970&lt;br/&gt;External]\n        UI[UI&lt;br/&gt;Port 1968&lt;br/&gt;External]\n        Storage[(Shared Index Storage&lt;br/&gt;NFS/EFS)]\n    end\n\n    DB[(Client Data Source&lt;br/&gt;MySQL/PostgreSQL/etc)]\n\n    Client --&gt;|REST API&lt;br/&gt;JSON/Protobuf| Search\n    Client --&gt;|REST API&lt;br/&gt;JSON| Ingest\n    Client -.-&gt;|Web Browser| UI\n\n    UI --&gt;|HTTP| Search\n    Search --&gt;|Protobuf&lt;br/&gt;Internal| Score\n\n    Search --&gt;|Read| Storage\n    Ingest --&gt;|Read/Write| Storage\n\n    Ingest --&gt;|Read| DB\n\n    classDef external fill:#4A90E2,stroke:#2E5C8A,stroke-width:2px,color:#fff\n    classDef internal fill:#95A5A6,stroke:#7F8C8D,stroke-width:2px,color:#fff\n    classDef storage fill:#F39C12,stroke:#D68910,stroke-width:2px,color:#fff\n    classDef clientdata fill:#E74C3C,stroke:#C0392B,stroke-width:2px,color:#fff\n\n    class Search,Ingest,UI external\n    class Score internal\n    class Storage storage\n    class DB clientdata</code></pre>"},{"location":"overview/#data-flow","title":"Data Flow","text":"<p>Ingestion Process:</p> <p>The Ingestion Service connects to your database, reads person records, and builds optimised search indexes. These indexes are written to shared storage (NFS/EFS) accessible to all Search Service instances. You can trigger a full refresh to rebuild all indexes, or incrementally sync specific records by ID.</p> <p>Search Workflow:</p> <ol> <li>Client application sends search request (first name, last name, date of birth) to Search Service via REST API</li> <li>Search Service executes searches across indexes</li> <li>Score Service calculates match scores</li> <li>Results are ranked by score and filtered by configurable minimum threshold</li> <li>Scored, ranked matches returned to client application with detailed score breakdowns</li> </ol> <p>Typical Performance: Sub-second search responses across datasets of 10M+ records.</p>"},{"location":"overview/#deployment","title":"Deployment","text":"<p>Tetra Connect is designed for production deployment on your cloud provider or on-premises infrastructure. All services are distributed as Docker images and configured via environment variables, making deployment flexible across different platforms.</p> <p>For detailed deployment instructions, see the Deployment Guide.</p>"},{"location":"overview/#integration","title":"Integration","text":"<p>For detailed integration instructions, see the Integration Guide.</p>"},{"location":"api/ingestion-service/","title":"Ingestion Service","text":""},{"location":"api/ingestion-service/#ingestion-service","title":"Ingestion Service","text":"<p>The Ingestion Service manages data synchronisation between the source database and the search index. It handles full index rebuilds and incremental updates.</p>"},{"location":"api/ingestion-service/#data","title":"Data","text":""},{"location":"api/ingestion-service/#post-apirefresh","title":"POST /api/refresh","text":"<p>Full index refresh</p> <p>Description Performs an asynchronous refresh of the search index by re-ingesting all records from the data source. This is a long-running operation that rebuilds the entire index.</p> <p>Use this operation when: - Initial index population is needed - Index corruption is suspected - Schema changes require a full rebuild</p>"},{"location":"api/ingestion-service/#response-200-ok","title":"Response 200 OK","text":""},{"location":"api/ingestion-service/#post-apisync","title":"POST /api/sync","text":"<p>Sync specific records</p> <p>Description Synchronises the search index for specific records identified by their external IDs. Use this for incremental updates when only certain records have changed.</p> <p>This is more efficient than a full refresh when updating a small number of records.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description externalIds query array No External IDs of records to synchronise"},{"location":"api/ingestion-service/#response-200-ok_1","title":"Response 200 OK","text":""},{"location":"api/ingestion-service/#get-apisize","title":"GET /api/size","text":"<p>Get index size</p> <p>Description Returns the total number of documents currently stored in the search index.</p>"},{"location":"api/ingestion-service/#response-200-ok_2","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>1000000\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"integer\",\n    \"format\": \"int64\"\n}\n</code></pre>"},{"location":"api/ingestion-service/#operations","title":"Operations","text":""},{"location":"api/ingestion-service/#get-actuatorhealth","title":"GET /actuator/health","text":"<p>Health check</p> <p>Description Returns the health status of the service.</p>"},{"location":"api/ingestion-service/#response-200-ok_3","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/ingestion-service/#get-actuatorhealthliveness","title":"GET /actuator/health/liveness","text":"<p>Liveness probe</p> <p>Description Kubernetes liveness probe endpoint.</p>"},{"location":"api/ingestion-service/#response-200-ok_4","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/ingestion-service/#get-actuatorhealthreadiness","title":"GET /actuator/health/readiness","text":"<p>Readiness probe</p> <p>Description Kubernetes readiness probe endpoint.</p>"},{"location":"api/ingestion-service/#response-200-ok_5","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/ingestion-service/#get-actuatorprometheus","title":"GET /actuator/prometheus","text":"<p>Prometheus metrics</p> <p>Description Returns metrics in Prometheus format.</p>"},{"location":"api/ingestion-service/#response-200-ok_6","title":"Response 200 OK","text":"<p>text/plain</p> <pre><code>\"# HELP jvm_memory_used_bytes The amount of used memory\\n# TYPE jvm_memory_used_bytes gauge\\njvm_memory_used_bytes{area=\\\"heap\\\"} 1.234567E8\\n\"\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"string\"\n}\n</code></pre>"},{"location":"api/ingestion-service/#schemas","title":"Schemas","text":""},{"location":"api/ingestion-service/#healthresponse","title":"HealthResponse","text":"Name Type status string"},{"location":"api/ingestion-service/#tags","title":"Tags","text":"Name Description Data Index data management operations Operations Health and monitoring endpoints"},{"location":"api/score-service/","title":"Score Service","text":""},{"location":"api/score-service/#score-service","title":"Score Service","text":"<p>Internal service used by the Search Service. The public documentation covers only the operational endpoints.</p>"},{"location":"api/score-service/#operations","title":"Operations","text":""},{"location":"api/score-service/#get-actuatorhealth","title":"GET /actuator/health","text":"<p>Health check</p> <p>Description Returns the health status of the service.</p>"},{"location":"api/score-service/#response-200-ok","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/score-service/#get-actuatorhealthliveness","title":"GET /actuator/health/liveness","text":"<p>Liveness probe</p> <p>Description Kubernetes liveness probe endpoint.</p>"},{"location":"api/score-service/#response-200-ok_1","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/score-service/#get-actuatorhealthreadiness","title":"GET /actuator/health/readiness","text":"<p>Readiness probe</p> <p>Description Kubernetes readiness probe endpoint.</p>"},{"location":"api/score-service/#response-200-ok_2","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/score-service/#get-actuatorprometheus","title":"GET /actuator/prometheus","text":"<p>Prometheus metrics</p> <p>Description Returns metrics in Prometheus format.</p>"},{"location":"api/score-service/#response-200-ok_3","title":"Response 200 OK","text":"<p>text/plain</p> <pre><code>\"# HELP jvm_memory_used_bytes The amount of used memory\\n# TYPE jvm_memory_used_bytes gauge\\njvm_memory_used_bytes{area=\\\"heap\\\"} 1.234567E8\\n\"\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"string\"\n}\n</code></pre>"},{"location":"api/score-service/#schemas","title":"Schemas","text":""},{"location":"api/score-service/#healthresponse","title":"HealthResponse","text":"Name Type status string"},{"location":"api/score-service/#tags","title":"Tags","text":"Name Description Operations Health and monitoring endpoints"},{"location":"api/search-service/","title":"Search Service","text":""},{"location":"api/search-service/#search-service","title":"Search Service","text":"<p>The Search Service provides API endpoints to search records.</p>"},{"location":"api/search-service/#search","title":"Search","text":""},{"location":"api/search-service/#get-apisearch","title":"GET /api/search","text":"<p>Search for a person</p> <p>Description Performs a fuzzy search against the person index using the provided criteria. Returns matched results with detailed scoring breakdown showing how each match was calculated.</p> <p>The search uses configurable edit distances for fuzzy matching on names and dates.</p> <p>Input parameters</p> Parameter In Type Default Nullable Description dob query string No Date of birth in yyyy-MM-dd format firstName query string No First name to search for lastName query string No Last name to search for maxNoOfResults query integer Yes Maximum number of results to return middleNames query string Yes Middle name(s) to search for minimumResponseScore query number Yes Minimum score threshold (0-1). Results below this score are filtered out."},{"location":"api/search-service/#response-200-ok","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"personSearch\": {\n        \"firstName\": \"John\",\n        \"middleNames\": \"William\",\n        \"lastName\": \"Smith\",\n        \"dob\": {\n            \"year\": 1985,\n            \"month\": 6,\n            \"day\": 15\n        },\n        \"maxNoOfResults\": 10,\n        \"minimumResponseScore\": \"0.6\"\n    },\n    \"searchResults\": [\n        {\n            \"externalId\": \"EXT-123456\",\n            \"firstName\": \"John\",\n            \"middleNames\": \"William\",\n            \"lastName\": \"Smith\",\n            \"dob\": {\n                \"year\": 1985,\n                \"month\": 6,\n                \"day\": 15\n            },\n            \"calculatedScore\": {\n                \"type\": \"WEIGHTED\",\n                \"name\": \"Person Score\",\n                \"context\": \"PERSON\",\n                \"value\": \"0.92\",\n                \"weight\": 1,\n                \"childScores\": [\n                    {\n                        \"type\": \"STRING_DISTANCE\",\n                        \"name\": \"First Name Score\",\n                        \"context\": \"FIRST_NAME\",\n                        \"value\": \"1.0\",\n                        \"weight\": 1\n                    },\n                    {\n                        \"type\": \"STRING_DISTANCE\",\n                        \"name\": \"Last Name Score\",\n                        \"context\": \"LAST_NAME\",\n                        \"value\": \"1.0\",\n                        \"weight\": 1\n                    },\n                    {\n                        \"type\": \"DATE_DISTANCE\",\n                        \"name\": \"DOB Score\",\n                        \"context\": \"DATE_OF_BIRTH\",\n                        \"value\": \"1.0\",\n                        \"weight\": 1\n                    }\n                ]\n            }\n        }\n    ],\n    \"noOfResults\": 1,\n    \"totalNumberOfRecordsSearched\": 1000000,\n    \"searchTimeInMillis\": 45,\n    \"scoreTimeInMillis\": 120,\n    \"totalTimeInMillis\": 165\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Search response containing matched results and metadata\",\n    \"properties\": {\n        \"personSearch\": {\n            \"$ref\": \"#/components/schemas/PersonSearch\"\n        },\n        \"searchResults\": {\n            \"type\": \"array\",\n            \"description\": \"List of matched search results, ordered by score descending\",\n            \"items\": {\n                \"$ref\": \"#/components/schemas/SearchResult\"\n            }\n        },\n        \"noOfResults\": {\n            \"type\": \"integer\",\n            \"format\": \"int32\",\n            \"description\": \"Number of results returned\",\n            \"example\": 1\n        },\n        \"totalNumberOfRecordsSearched\": {\n            \"type\": \"integer\",\n            \"format\": \"int64\",\n            \"description\": \"Total records searched in the index\",\n            \"example\": 1000000\n        },\n        \"searchTimeInMillis\": {\n            \"type\": \"integer\",\n            \"format\": \"int64\",\n            \"description\": \"Time spent searching in milliseconds\",\n            \"example\": 45\n        },\n        \"scoreTimeInMillis\": {\n            \"type\": \"integer\",\n            \"format\": \"int64\",\n            \"description\": \"Time spent scoring in milliseconds\",\n            \"example\": 120\n        },\n        \"totalTimeInMillis\": {\n            \"type\": \"integer\",\n            \"format\": \"int64\",\n            \"description\": \"Total operation time in milliseconds\",\n            \"example\": 165\n        }\n    }\n}\n</code></pre>"},{"location":"api/search-service/#index","title":"Index","text":""},{"location":"api/search-service/#get-apisize","title":"GET /api/size","text":"<p>Get index size</p> <p>Description Returns the total number of documents currently stored in the search index.</p>"},{"location":"api/search-service/#response-200-ok_1","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>1000000\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"integer\",\n    \"format\": \"int64\"\n}\n</code></pre>"},{"location":"api/search-service/#operations","title":"Operations","text":""},{"location":"api/search-service/#get-actuatorhealth","title":"GET /actuator/health","text":"<p>Health check</p> <p>Description Returns the health status of the service.</p>"},{"location":"api/search-service/#response-200-ok_2","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/search-service/#get-actuatorhealthliveness","title":"GET /actuator/health/liveness","text":"<p>Liveness probe</p> <p>Description Kubernetes liveness probe endpoint.</p>"},{"location":"api/search-service/#response-200-ok_3","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/search-service/#get-actuatorhealthreadiness","title":"GET /actuator/health/readiness","text":"<p>Readiness probe</p> <p>Description Kubernetes readiness probe endpoint.</p>"},{"location":"api/search-service/#response-200-ok_4","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/search-service/#get-actuatorprometheus","title":"GET /actuator/prometheus","text":"<p>Prometheus metrics</p> <p>Description Returns metrics in Prometheus format.</p>"},{"location":"api/search-service/#response-200-ok_5","title":"Response 200 OK","text":"<p>text/plain</p> <pre><code>\"# HELP jvm_memory_used_bytes The amount of used memory\\n# TYPE jvm_memory_used_bytes gauge\\njvm_memory_used_bytes{area=\\\"heap\\\"} 1.234567E8\\n\"\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"string\"\n}\n</code></pre>"},{"location":"api/search-service/#schemas","title":"Schemas","text":""},{"location":"api/search-service/#healthresponse","title":"HealthResponse","text":"Name Type status string"},{"location":"api/search-service/#personsearch","title":"PersonSearch","text":"Name Type dob ProtoDate firstName string lastName string maxNoOfResults integer(int64) middleNames string minimumResponseScore string"},{"location":"api/search-service/#protodate","title":"ProtoDate","text":"Name Type day integer(int32) month integer(int32) year integer(int32)"},{"location":"api/search-service/#score","title":"Score","text":"Name Type childScores Array&lt;Score&gt; context string name string type string value string weight integer(int32)"},{"location":"api/search-service/#searchresponse","title":"SearchResponse","text":"Name Type noOfResults integer(int32) personSearch PersonSearch scoreTimeInMillis integer(int64) searchResults Array&lt;SearchResult&gt; searchTimeInMillis integer(int64) totalNumberOfRecordsSearched integer(int64) totalTimeInMillis integer(int64)"},{"location":"api/search-service/#searchresult","title":"SearchResult","text":"Name Type calculatedScore Score dob ProtoDate externalId string firstName string lastName string middleNames string"},{"location":"api/search-service/#tags","title":"Tags","text":"Name Description Search Person search operations Index Index management operations Operations Health and monitoring endpoints"},{"location":"api/search-service/#response-formats","title":"Response Formats","text":"<p>The API supports two response formats via content negotiation:</p> Format Content-Type JSON <code>application/json</code> Protocol Buffers <code>application/x-protobuf</code> <p>Note: Protocol Buffers responses are not shown above because they are a binary format. For integration details, see the Integration Guide.</p>"},{"location":"api/ui/","title":"UI Service","text":""},{"location":"api/ui/#ui","title":"UI","text":"<p>User Interface for ad-hoc search queries. This specification documents only the operational endpoints.</p>"},{"location":"api/ui/#operations","title":"Operations","text":""},{"location":"api/ui/#get-actuatorhealth","title":"GET /actuator/health","text":"<p>Health check</p> <p>Description Returns the health status of the service.</p>"},{"location":"api/ui/#response-200-ok","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/ui/#get-actuatorhealthliveness","title":"GET /actuator/health/liveness","text":"<p>Liveness probe</p> <p>Description Kubernetes liveness probe endpoint.</p>"},{"location":"api/ui/#response-200-ok_1","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/ui/#get-actuatorhealthreadiness","title":"GET /actuator/health/readiness","text":"<p>Readiness probe</p> <p>Description Kubernetes readiness probe endpoint.</p>"},{"location":"api/ui/#response-200-ok_2","title":"Response 200 OK","text":"<p>application/json</p> <pre><code>{\n    \"status\": \"UP\"\n}\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"object\",\n    \"description\": \"Health check response\",\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"Health status\",\n            \"enum\": [\n                \"UP\",\n                \"DOWN\"\n            ],\n            \"example\": \"UP\"\n        }\n    }\n}\n</code></pre>"},{"location":"api/ui/#get-actuatorprometheus","title":"GET /actuator/prometheus","text":"<p>Prometheus metrics</p> <p>Description Returns metrics in Prometheus format.</p>"},{"location":"api/ui/#response-200-ok_3","title":"Response 200 OK","text":"<p>text/plain</p> <pre><code>\"# HELP jvm_memory_used_bytes The amount of used memory\\n# TYPE jvm_memory_used_bytes gauge\\njvm_memory_used_bytes{area=\\\"heap\\\"} 1.234567E8\\n\"\n</code></pre> <p>Schema of the response body</p> <pre><code>{\n    \"type\": \"string\"\n}\n</code></pre>"},{"location":"api/ui/#schemas","title":"Schemas","text":""},{"location":"api/ui/#healthresponse","title":"HealthResponse","text":"Name Type status string"},{"location":"api/ui/#tags","title":"Tags","text":"Name Description Operations Health and monitoring endpoints"},{"location":"guide/ingestion/","title":"Data Ingestion","text":"<p>This guide covers loading data from your database and building searchable indexes using the ingestion service.</p>"},{"location":"guide/ingestion/#data-schema-requirements","title":"Data Schema Requirements","text":"<p>Tetra Connect expects your database to contain person records with three required columns. Whilst the table and column names are configurable via environment variables, the data format is standardised.</p> <p>Required columns</p> Field Format Description Example External ID String/Number Unique identifier for the record. Used to link search results back to your source data. <code>12345</code>, <code>EMP001</code> Name Space-separated string Full name containing first name, optional middle name(s), and last name. <code>John Smith</code>, <code>Jane Marie Doe</code> Date of Birth <code>YYYY-MM-DD</code> ISO 8601 date format <code>1990-01-15</code> <p>Data quality expectations</p> <ul> <li>External ID: Must be unique across all records</li> <li>Name: Must contain at least first and last name separated by space. Middle names are optional.</li> <li>Date of Birth: Must be a valid date in <code>YYYY-MM-DD</code> format</li> </ul> <p>Data Preparation</p> <p>Tetra Connect assumes your data is clean and meets these format requirements. It is your responsibility to ensure data quality before ingestion. Invalid or malformed data may result in indexing errors or poor search quality.</p> <p>Configuring column mapping</p> <p>Map your database columns to these fields using environment variables on the Ingestion Service:</p> <pre><code>TETRA_CONNECT_DATASOURCE_TABLE_NAME=persons\nTETRA_CONNECT_DATASOURCE_COLUMN_NAMES_SOURCEUNIQUEID=person_id\nTETRA_CONNECT_DATASOURCE_COLUMN_NAMES_SOURCENAME=full_name\nTETRA_CONNECT_DATASOURCE_COLUMN_NAMES_SOURCEDOB=dob\n</code></pre> <p>See the Deployment Guide for full configuration details.</p>"},{"location":"guide/ingestion/#before-you-begin","title":"Before You Begin","text":"<p>Ensure you have:</p> <ul> <li>Completed deployment and all services are healthy</li> <li>Database populated with person records matching the schema requirements above</li> <li>Sufficient disk space on shared storage for indexes (approximately 1GB per 1M records)</li> </ul>"},{"location":"guide/ingestion/#full-refresh","title":"Full Refresh","text":"<p>A full refresh rebuilds all indexes from scratch by reading all records from your database. This operation deletes existing indexes and re-processes every record.</p> <p>When to use</p> <ul> <li>Initial setup after deployment</li> <li>After significant database changes</li> <li>To rebuild indexes from scratch</li> </ul> <p>Triggering a full refresh</p> <pre><code>curl -X POST http://&lt;ingestion-service-url&gt;/api/refresh\n</code></pre> <p>Asynchronous Operation</p> <p>The refresh endpoint is asynchronous. The API returns immediately whilst ingestion runs in the background. Monitor the Ingestion Service logs to track progress.</p> <p>This will:</p> <ol> <li>Connect to your configured database</li> <li>Read all records from the configured table</li> <li>Build searchable indexes</li> <li>Write indexes to shared storage</li> </ol> <p>Monitor progress</p> <p>Check the Ingestion Service logs to monitor progress. Look for messages indicating batch processing:</p> <pre><code>Processing batch number: 1\nCompleted indexing batch number: 1\nProcessing batch number: 2\nCompleted indexing batch number: 2\n...\nRefresh complete - processed 1000000 records in 120 seconds\n</code></pre> <p>Each batch processes the configured number of records (default: 100,000). The final message confirms total records indexed and time taken.</p>"},{"location":"guide/ingestion/#sync-specific-records","title":"Sync Specific Records","text":"<p>Synchronise specific records by their external IDs without rebuilding the entire index.</p> <p>When to use</p> <ul> <li>Update specific records after changes</li> <li>Add newly created records</li> <li>Refresh a subset of data</li> </ul> <p>Syncing records</p> <pre><code>curl -X POST \"http://&lt;ingestion-service-url&gt;/api/sync?externalIds=id1,id2,id3\"\n</code></pre> <p>Example: <pre><code>curl -X POST \"http://localhost:1970/api/sync?externalIds=12345,67890,11111\"\n</code></pre></p> <p>Synchronous Operation</p> <p>The sync endpoint is synchronous. The API waits for the sync to complete before returning. This is suitable for small numbers of records.</p> <p>This will synchronise only the specified records from your database.</p>"},{"location":"guide/ingestion/#verify-ingestion","title":"Verify Ingestion","text":"<p>After ingestion completes, verify the indexes were created successfully.</p> <p>Check index size</p> <pre><code>curl http://&lt;ingestion-service-url&gt;/api/size\n</code></pre> <p>The returned number should match your expected record count.</p> <p>Check shared storage</p> <p>Verify index files exist in shared storage:</p> <pre><code># List index files in shared storage location (TETRA_CONNECT_INDEX_DIRECTORY)\n# Default location: /tmp/tetra-connect\nls -la /mnt/shared-storage\n</code></pre> <p>You should see index files and directories (segments_, .cfs, write.lock, etc.).</p> <p>Test a search</p> <p>Verify searches work against the new indexes:</p> <pre><code>curl \"http://&lt;search-service-url&gt;/api/search?firstName=John&amp;lastName=Smith&amp;dob=1990-01-15\"\n</code></pre> <p>If you get results, ingestion was successful!</p>"},{"location":"guide/ingestion/#ingestion-performance","title":"Ingestion Performance","text":"<p>Ingestion performance depends on several factors:</p> <ul> <li>Dataset size - More records take longer</li> <li>Database performance - Query speed affects ingestion speed</li> <li>Batch size - Configurable via <code>TETRA_CONNECT_INDEX_BATCH_SIZE</code> (default: 100,000)</li> <li>Resources - CPU and memory allocated to Ingestion Service</li> </ul> <p>Typical ingestion rates</p> <p>With standard configuration, expect approximately 1 million records per minute. For example:</p> <ul> <li>1 million records: ~1 minute</li> <li>10 million records: ~10 minutes</li> <li>50 million records: ~50 minutes</li> </ul> <p>Actual performance may vary based on your hardware, database speed, and configuration.</p> <p>Performance tuning</p> <p>If ingestion is slower than expected, consider adjusting these configuration options.</p>"},{"location":"guide/ingestion/#batch-size","title":"Batch Size","text":"<p><code>TETRA_CONNECT_INDEX_BATCH_SIZE</code> (default: <code>100000</code>)</p> <p>Number of records fetched from the database and processed per batch.</p> <ul> <li>Larger values: Faster ingestion but higher memory usage</li> <li>Smaller values: Lower memory usage but more database queries</li> <li>Recommendation: Start with default, increase if you have sufficient memory</li> </ul>"},{"location":"guide/ingestion/#memory-buffer","title":"Memory Buffer","text":"<p><code>TETRA_CONNECT_INDEX_MEMORY_SIZE</code> (default: <code>1024</code>)</p> <p>RAM buffer size in MB for the index writer. Controls how much data is buffered in memory before writing to disk.</p> <ul> <li>Larger values: Fewer disk writes, faster indexing</li> <li>Smaller values: More frequent disk writes, lower memory usage</li> <li>Recommendation: Set to 25-50% of available container memory</li> </ul>"},{"location":"guide/ingestion/#thread-pool","title":"Thread Pool","text":"<p><code>TETRA_CONNECT_INDEX_THREAD_POOL_SIZE</code> (default: <code>8</code>)</p> <p>Number of parallel threads for batch processing.</p> <ul> <li>Larger values: More parallel processing if you have CPU cores available</li> <li>Lower values: Reduced CPU usage and memory pressure</li> <li>Recommendation: Match to available CPU cores</li> </ul>"},{"location":"guide/ingestion/#index-sharding","title":"Index Sharding","text":"<p><code>TETRA_CONNECT_INDEX_SHARDS_NUMBER</code> (default: <code>5</code>)</p> <p>Number of index shards for parallel indexing and searching. The index is split into multiple shards that can be processed concurrently.</p> <ul> <li>More shards: Better parallelisation for very large datasets (&gt;10M records)</li> <li>Fewer shards: Lower overhead for smaller datasets</li> <li>Recommendation: The default of 5 shards works well for most use cases. Only adjust for very large datasets or specific performance requirements.</li> </ul> <p>Applies to Both Services</p> <p>This setting affects both Ingestion Service and Search Service. Both must use the same value.</p> <p>Other performance factors</p> <ul> <li>Database performance: Ensure your database can handle the read load efficiently</li> <li>Network latency: Minimise network distance between Ingestion Service and database</li> <li>Disk I/O: Shared storage write performance affects indexing speed</li> <li>Container resources: Ensure sufficient CPU and memory allocated to Ingestion Service</li> </ul> <p>See the Deployment Guide for configuration examples.</p>"},{"location":"guide/ingestion/#impact-during-ingestion","title":"Impact During Ingestion","text":"<p>TBD</p>"},{"location":"guide/ingestion/#next-steps","title":"Next Steps","text":"<ul> <li>Perform searches to test your indexed data and learn about tuning search behaviour</li> </ul>"},{"location":"guide/operations/","title":"Operations","text":"<p>TBC</p>"},{"location":"guide/searching/","title":"Performing Searches","text":"<p>This guide explains how to search for person records using the Tetra Connect Search Service.</p>"},{"location":"guide/searching/#overview","title":"Overview","text":"<p>The Search Service provides matching capabilities for finding person records based on name and date of birth. It offers fast, scalable searching with configurable search options.</p>"},{"location":"guide/searching/#search-endpoint","title":"Search Endpoint","text":""},{"location":"guide/searching/#basic-search","title":"Basic Search","text":"<pre><code>GET /api/search?firstName=John&amp;lastName=Smith&amp;dob=1980-01-15\n</code></pre> <p>Required Parameters:</p> <ul> <li><code>firstName</code> - First name to search for</li> <li><code>lastName</code> - Last name to search for</li> <li><code>dob</code> - Date of birth in ISO format (yyyy-MM-dd)</li> </ul> <p>Optional Parameters:</p> <ul> <li><code>middleNames</code> - Middle names (defaults to empty if not provided)</li> <li><code>maxNoOfResults</code> - Maximum number of results to return</li> <li><code>minimumResponseScore</code> - Minimum score threshold (defaults to 0.6)</li> </ul>"},{"location":"guide/searching/#example-request","title":"Example Request","text":"<pre><code>curl \"http://localhost:1967/api/search?\\\nfirstName=John&amp;\\\nlastName=Smith&amp;\\\ndob=1980-01-15&amp;\\\nmaxNoOfResults=10&amp;\\\nminimumResponseScore=0.7\"\n</code></pre>"},{"location":"guide/searching/#search-response","title":"Search Response","text":""},{"location":"guide/searching/#response-structure","title":"Response Structure","text":"<pre><code>{\n  \"personSearch\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Smith\",\n    \"middleNames\": \"\",\n    \"dob\": \"1980-01-15\"\n  },\n  \"searchResults\": [\n    {\n      \"externalId\": \"12345\",\n      \"firstName\": \"John\",\n      \"middleNames\": \"Michael\",\n      \"lastName\": \"Smith\",\n      \"dob\": \"1980-01-15\",\n      \"calculatedScore\": {\n        \"type\": \"WEIGHTED\",\n        \"name\": \"Person Score\",\n        \"context\": \"PERSON\",\n        \"value\": \"0.95\",\n        \"weight\": 100,\n        \"childScores\": [...]\n      }\n    }\n  ],\n  \"noOfResults\": 1,\n  \"totalNumberOfRecordsSearched\": 1000000,\n  \"searchTimeInMillis\": 45,\n  \"scoreTimeInMillis\": 120,\n  \"totalTimeInMillis\": 165\n}\n</code></pre>"},{"location":"guide/searching/#response-fields","title":"Response Fields","text":"<p>Top Level:</p> <ul> <li><code>personSearch</code> - Echo of the search parameters</li> <li><code>searchResults</code> - Array of matching results, ranked by score</li> <li><code>noOfResults</code> - Number of results returned</li> <li><code>totalNumberOfRecordsSearched</code> - Total documents in the index</li> <li><code>searchTimeInMillis</code> - Time taken for search phase</li> <li><code>scoreTimeInMillis</code> - Time taken for scoring phase</li> <li><code>totalTimeInMillis</code> - Total processing time</li> </ul> <p>Search Result:</p> <ul> <li><code>externalId</code> - External identifier from source data</li> <li><code>firstName</code> - First name</li> <li><code>middleNames</code> - Middle names (may be empty)</li> <li><code>lastName</code> - Last name</li> <li><code>dob</code> - Date of birth</li> <li><code>calculatedScore</code> - Detailed scoring breakdown</li> </ul>"},{"location":"guide/searching/#score-based-ranking","title":"Score-Based Ranking","text":"<p>All search results are scored based on relevance using multiple strategies:</p> <ul> <li>String Distance</li> <li>Phonetic Similarity</li> <li>Date Range Matching</li> <li>Synonym Matching</li> </ul> <p>Results are ranked by their calculated score, with the highest scoring matches returned first.</p>"},{"location":"guide/searching/#filtering-results","title":"Filtering Results","text":""},{"location":"guide/searching/#score-threshold","title":"Score Threshold","text":"<p>Use <code>minimumResponseScore</code> to filter out low-quality matches:</p> <pre><code># Only return results with score &gt;= 0.8\ncurl \"http://localhost:1967/api/search?\\\nfirstName=John&amp;lastName=Smith&amp;dob=1980-01-15&amp;\\\nminimumResponseScore=0.8\"\n</code></pre>"},{"location":"guide/searching/#limiting-results","title":"Limiting Results","text":"<p>Use <code>maxNoOfResults</code> to limit the number of returned results:</p> <pre><code># Return only top 5 matches\ncurl \"http://localhost:1967/api/search?\\\nfirstName=John&amp;lastName=Smith&amp;dob=1980-01-15&amp;\\\nmaxNoOfResults=5\"\n</code></pre> <p>Performance Recommendation</p> <p>Setting <code>maxNoOfResults</code> can improve performance for queries that would otherwise return many results. The Score Service will stop processing once the limit is reached.</p>"},{"location":"guide/searching/#response-formats","title":"Response Formats","text":"<p>Tetra Connect supports two response formats:</p>"},{"location":"guide/searching/#protocol-buffers","title":"Protocol Buffers","text":"<p>Protocol Buffers is the primary response format, providing optimal performance through a compact binary format:</p> <pre><code>curl -H \"Accept: application/x-protobuf\" \\\n  \"http://localhost:1967/api/search?...\"\n</code></pre> <p>Java Client Integration:</p> <p>Tetra Connect provides Protocol Buffers model API JARs that you can use in your Java client application:</p> <pre><code>// Add the dependency (published to GitHub Packages)\n// uk.co.tetra.connect:search-api-model:version\n\nimport uk.co.tetra.connect.search.proto.ProtoSearchRequest;\nimport uk.co.tetra.connect.search.proto.ProtoTetraConnectResult;\n\n// Use the models in your client code\nProtoTetraConnectResult result = searchServiceClient.search(request);\n</code></pre> <p>The Protocol Buffers models are available as JAR artefacts, allowing you to write strongly-typed Java clients without manually parsing responses.</p>"},{"location":"guide/searching/#json","title":"JSON","text":"<p>JSON is also supported for easier debugging:</p> <pre><code>curl -H \"Accept: application/json\" \\\n  \"http://localhost:1967/api/search?...\"\n</code></pre> <p>Performance Recommendation</p> <p>For production integrations, use Protocol Buffers with the provided Java model JARs. Protocol Buffers are faster to serialise/deserialise and consume less bandwidth than JSON.</p>"},{"location":"guide/searching/#checking-index-size","title":"Checking Index Size","text":"<p>To check how many records are currently in the search index:</p> <pre><code>curl \"http://localhost:1967/api/size\"\n</code></pre> <p>Response: <pre><code>1000000\n</code></pre></p> <p>This returns the total number of indexed records.</p>"},{"location":"guide/searching/#tuning-search-and-scoring-behaviour","title":"Tuning Search and Scoring Behaviour","text":"<p>Tetra Connect provides extensive configuration options via environment variables to tune search and scoring behaviour to match your data quality and performance requirements.</p> <p>Service Configuration</p> <p>Configuration is split between two services:</p> <ul> <li>Search Service - Controls query matching behaviour (fuzzy matching, date ranges for filtering)</li> <li>Score Service - Controls scoring behaviour (field weights, phonetic/synonym scaling)</li> </ul>"},{"location":"guide/searching/#field-weighting-score-service","title":"Field Weighting (Score Service)","text":"<p>Control how much each field contributes to the final score:</p> Setting Environment Variable Default Description First Name Weight <code>TETRA_CONNECT_FIELD_WEIGHT_FIRST_NAME</code> <code>30</code> Weight for first name in scoring Middle Names Weight <code>TETRA_CONNECT_FIELD_WEIGHT_MIDDLE_NAMES</code> <code>10</code> Weight for middle names in scoring Last Name Weight <code>TETRA_CONNECT_FIELD_WEIGHT_LAST_NAME</code> <code>40</code> Weight for last name in scoring (highest by default) Date of Birth Weight <code>TETRA_CONNECT_FIELD_WEIGHT_DOB</code> <code>30</code> Weight for date of birth in scoring <p>The weights determine relative importance. For example, with the default configuration, last name has the highest impact on the final score.</p>"},{"location":"guide/searching/#fuzzy-matching-tolerance-search-service","title":"Fuzzy Matching Tolerance (Search Service)","text":"<p>Configure how lenient fuzzy matching is for each field. Each field (firstName, lastName, dob) supports the following settings:</p>"},{"location":"guide/searching/#first-name-fuzzy-matching","title":"First Name Fuzzy Matching","text":"Setting Environment Variable Default Description Maximum Edit Distance <code>TETRA_CONNECT_QUERY_FIRSTNAME_MAXEDITS</code> <code>2</code> Maximum edit distance (0 = exact match only, 1-2 = fuzzy, allows 0-2 character differences) Prefix Match Length <code>TETRA_CONNECT_QUERY_FIRSTNAME_PREFIXLENGTH</code> <code>0</code> Number of initial characters that must match exactly Allow Transpositions <code>TETRA_CONNECT_QUERY_FIRSTNAME_TRANSPOSITIONS</code> <code>true</code> Whether to allow character transpositions (e.g., \"Jhon\" \u2192 \"John\") Query Expansion Limit <code>TETRA_CONNECT_QUERY_FIRSTNAME_MAXEXPANSIONS</code> <code>50</code> Limits query expansion (higher = more CPU, more matches)"},{"location":"guide/searching/#last-name-fuzzy-matching","title":"Last Name Fuzzy Matching","text":"Setting Environment Variable Default Description Maximum Edit Distance <code>TETRA_CONNECT_QUERY_LASTNAME_MAXEDITS</code> <code>2</code> Maximum edit distance (0 = exact match only, 1-2 = fuzzy, allows 0-2 character differences) Prefix Match Length <code>TETRA_CONNECT_QUERY_LASTNAME_PREFIXLENGTH</code> <code>0</code> Number of initial characters that must match exactly Allow Transpositions <code>TETRA_CONNECT_QUERY_LASTNAME_TRANSPOSITIONS</code> <code>true</code> Whether to allow character transpositions (e.g., \"Jhon\" \u2192 \"John\") Query Expansion Limit <code>TETRA_CONNECT_QUERY_LASTNAME_MAXEXPANSIONS</code> <code>50</code> Limits query expansion (higher = more CPU, more matches)"},{"location":"guide/searching/#date-of-birth-fuzzy-matching","title":"Date of Birth Fuzzy Matching","text":"Setting Environment Variable Default Description Maximum Edit Distance <code>TETRA_CONNECT_QUERY_DOB_MAXEDITS</code> <code>2</code> Maximum edit distance (0 = exact match only, 1-2 = fuzzy, allows 0-2 character differences) Prefix Match Length <code>TETRA_CONNECT_QUERY_DOB_PREFIXLENGTH</code> <code>0</code> Number of initial characters that must match exactly Allow Transpositions <code>TETRA_CONNECT_QUERY_DOB_TRANSPOSITIONS</code> <code>true</code> Whether to allow character transpositions (e.g., \"Jhon\" \u2192 \"John\") Query Expansion Limit <code>TETRA_CONNECT_QUERY_DOB_MAXEXPANSIONS</code> <code>50</code> Limits query expansion (higher = more CPU, more matches)"},{"location":"guide/searching/#date-of-birth-matching-range-both-services","title":"Date of Birth Matching Range (Both Services)","text":"<p>Configure the tolerance for date of birth matching:</p> Setting Environment Variable Default Description DOB Tolerance Range <code>TETRA_CONNECT_DATE_OF_BIRTH_RANGE_IN_DAYS</code> <code>5</code> Tolerance for DOB matching (\u00b15 days). Dates outside this range receive a score of 0. <p>Dates within the range are scored based on proximity to the search date.</p> <p>DOB Range Impact</p> <p>With <code>RANGE_IN_DAYS=5</code>:</p> <ul> <li>Search: 1980-01-15</li> <li>Match: 1980-01-15 \u2192 Score: 1.0 (exact match)</li> <li>Match: 1980-01-17 \u2192 Score: ~0.6 (2 days difference, within range)</li> <li>Match: 1980-01-20 \u2192 Score: ~0.0 (5 days difference, at boundary)</li> <li>Match: 1980-01-22 \u2192 Score: 0.0 (7 days difference, outside range)</li> </ul> <p>Configure on Both Services</p> <p>This setting must be configured on both Search Service and Score Service to ensure consistent behavior. The Search Service uses it for initial date filtering, while the Score Service uses it for scoring date proximity.</p>"},{"location":"guide/searching/#phonetic-and-synonym-scaling-score-service","title":"Phonetic and Synonym Scaling (Score Service)","text":"<p>Configure scoring for phonetic and synonym matches:</p> Setting Environment Variable Default Description Phonetic Match Scaling <code>TETRA_CONNECT_SCALE_PHONETICS</code> <code>0.9</code> Score multiplier for phonetic matches (90% of exact match score) Synonym Match Scaling <code>TETRA_CONNECT_SCALE_SYNONYMS</code> <code>0.9</code> Score multiplier for synonym matches (90% of exact match score) <p>These values scale down the score when a match is found via phonetics or synonyms rather than exact/fuzzy matching.</p>"},{"location":"guide/searching/#score-threshold-search-service","title":"Score Threshold (Search Service)","text":"<p>Set the minimum score for results to be returned:</p> Setting Environment Variable Default Description Minimum Response Score <code>TETRA_CONNECT_DEFAULT_MINIMUM_RESPONSE_SCORE</code> <code>0.6</code> Minimum score threshold for returning results. Can be overridden per request via <code>minimumResponseScore</code> query parameter. <p>Results with a score below this threshold are filtered out.</p>"},{"location":"guide/searching/#custom-synonyms-both-services","title":"Custom Synonyms (Both Services)","text":"<p>Add custom first name synonyms using environment variables:</p> Setting Environment Variable Format Example Description First Name Synonyms <code>TETRA_CONNECT_SYNONYMS_FIRST_NAMES_{NAME}</code> <code>TETRA_CONNECT_SYNONYMS_FIRST_NAMES_WILLIAM=bill,billy,will</code> Define synonyms for first names. <code>{NAME}</code> is the primary name (uppercase), value is comma-separated synonyms (lowercase). <p>Additional Examples:</p> <pre><code>TETRA_CONNECT_SYNONYMS_FIRST_NAMES_ROBERT=bob,rob,robbie\nTETRA_CONNECT_SYNONYMS_FIRST_NAMES_JAMES=jim,jimmy\nTETRA_CONNECT_SYNONYMS_FIRST_NAMES_ELIZABETH=liz,beth,betty\n</code></pre> <p>When a search uses \"William\", results containing \"Bill\", \"Billy\", or \"Will\" will be matched with a score scaled by <code>TETRA_CONNECT_SCALE_SYNONYMS</code> (default: 0.9).</p> <p>Configure on Both Services</p> <p>Custom synonyms must be configured on both Search Service and Score Service for proper functionality:</p> <ul> <li>Search Service - Uses synonyms during query matching to find records</li> <li>Score Service - Uses synonyms during scoring to apply synonym scaling factor</li> </ul>"},{"location":"guide/searching/#configuration-summary","title":"Configuration Summary","text":"<p>The following table summarises which service manages each configuration setting:</p> Configuration Search Service Score Service Notes Field Weighting (<code>TETRA_CONNECT_FIELD_WEIGHT_*</code>) \u2713 Controls relative importance of fields in scoring Fuzzy Matching (<code>TETRA_CONNECT_QUERY_*</code>) \u2713 Controls query matching tolerance DOB Range (<code>TETRA_CONNECT_DATE_OF_BIRTH_RANGE_IN_DAYS</code>) \u2713 \u2713 Configure on both services Phonetic/Synonym Scaling (<code>TETRA_CONNECT_SCALE_*</code>) \u2713 Score multipliers for phonetic/synonym matches Score Threshold (<code>TETRA_CONNECT_DEFAULT_MINIMUM_RESPONSE_SCORE</code>) \u2713 Filters results below threshold Custom Synonyms (<code>TETRA_CONNECT_SYNONYMS_FIRST_NAMES_*</code>) \u2713 \u2713 Configure on both services"},{"location":"guide/searching/#next-steps","title":"Next Steps","text":"<ul> <li>Review the Search Service API Reference for detailed API integration patterns</li> <li>See the Integration Guide to integrate Tetra Connect into your application</li> <li>Try the UI for interactive searching and testing</li> </ul>"},{"location":"guide/user-interface/","title":"User Interface","text":"<p>The Tetra Connect UI is a web application that provides an interactive interface for performing searches, viewing detailed scoring breakdowns, and inspecting scoring configuration.</p>"},{"location":"guide/user-interface/#overview","title":"Overview","text":"<p>The UI is designed for:</p> <ul> <li>Testing and validation - Perform ad-hoc searches during development and testing</li> <li>Score analysis - View detailed scoring breakdowns to understand match quality</li> <li>Configuration inspection - Review active scoring configuration</li> <li>Demonstration - Show Tetra Connect capabilities to stakeholders</li> </ul> <p>Not Required for Production</p> <p>The UI is optional. Production systems typically integrate directly with the Search Service API. The UI is primarily useful for testing, debugging, and demonstration purposes.</p>"},{"location":"guide/user-interface/#accessing-the-ui","title":"Accessing the UI","text":"<p>The UI is accessible via the endpoint configured in your deployment:</p> <p>Refer to your Deployment Guide for platform-specific endpoint configuration.</p>"},{"location":"guide/user-interface/#search-page","title":"Search Page","text":"<p>The Search page is the main interface for performing person searches.</p>"},{"location":"guide/user-interface/#performing-a-search","title":"Performing a Search","text":"<p>Enter the search criteria (first name, middle names, last name, date of birth), configure options (max results, minimum score threshold), and click Search.</p> <p></p> <p>The search form includes:</p> <ul> <li>Required fields: First Name, Last Name, Date of Birth</li> <li>Optional field: Middle Names</li> <li>Max no of Results: Dropdown to limit results (10, 25, 50, 100, 250, or All)</li> <li>Min Score Threshold: Interactive slider (0.0 - 1.0, default 0.6)</li> </ul>"},{"location":"guide/user-interface/#search-results","title":"Search Results","text":"<p>Results display with performance metrics showing timing breakdown (search time, score time, total time) and result count. Each row shows rank, external ID, full name, date of birth, and overall match score.</p>"},{"location":"guide/user-interface/#viewing-score-breakdown","title":"Viewing Score Breakdown","text":"<p>Click on any result row to expand and view detailed scoring information. The breakdown shows two levels:</p> <ol> <li>Field-Level Scores - How each field (First Name, Last Name, DOB) contributed to the overall score, including the field weight and field score value</li> <li>Score Type Level - Click a field to expand further and see individual score types with their weights and scores</li> </ol> <p></p> <p>Understanding Low Scores</p> <p>Use the score breakdown to diagnose why a match has a low score. You can see which fields or score types are contributing negatively and adjust configuration accordingly.</p>"},{"location":"guide/user-interface/#configuration-page","title":"Configuration Page","text":"<p>The Configuration page displays the active scoring configuration retrieved from the Score Service. Navigate to Config in the top navigation bar.</p> <p></p> <p>The configuration shows each field's scoring setup including: - Score context, type, weight, and scale for each field - Child scorer configurations showing active score types with their descriptions and scaling factors</p> <p>Read-Only View</p> <p>The configuration page is read-only. To modify configuration, update environment variables on the Score Service and restart the service.</p> <p>Use Cases: - Verify active configuration after making environment variable changes - Understand which score types are active and their weights - Show stakeholders how scoring is configured - Troubleshoot unexpected scoring behavior</p>"},{"location":"guide/user-interface/#tips-and-best-practices","title":"Tips and Best Practices","text":""},{"location":"guide/user-interface/#for-testing","title":"For Testing","text":"<ul> <li>Start with broad searches - Use lower score thresholds (0.5-0.6) initially to see more results</li> <li>Iterate threshold values - Use the slider to experiment with different minimum score thresholds</li> <li>Expand score breakdowns - Always inspect low-scoring results to understand why they scored poorly</li> <li>Test edge cases - Try misspellings, transpositions, and phonetic variations</li> </ul>"},{"location":"guide/user-interface/#for-troubleshooting","title":"For Troubleshooting","text":"<ul> <li>Compare API vs UI - If results differ, compare UI searches with direct API calls</li> <li>Check configuration - Use the Config page to verify active settings match expectations</li> <li>Test different thresholds - Lower the minimum score to see if results are being filtered out</li> <li>Review field scores - Identify which fields are contributing to unexpected scores</li> </ul>"},{"location":"setup/deployment/","title":"Deployment Guide","text":"<p>This guide covers deploying Tetra Connect to your environment. The system is container-based and can be deployed using any orchestration platform or directly with Docker.</p>"},{"location":"setup/deployment/#before-you-begin","title":"Before You Begin","text":""},{"location":"setup/deployment/#prerequisites","title":"Prerequisites","text":"<p>Ensure you have the following before starting deployment.</p>"},{"location":"setup/deployment/#container-platform","title":"Container platform","text":"<ul> <li>Kubernetes, Docker Swarm, Amazon ECS, Docker runtime, etc.</li> </ul>"},{"location":"setup/deployment/#shared-storage","title":"Shared storage","text":"<ul> <li>Shared filesystem accessible by multiple services (e.g. NFS, Amazon EFS, Azure Files, etc.)</li> <li>Used for sharing indexes between services</li> <li>Capacity guideline: approximately 1GB per 1M records (varies by data)</li> </ul>"},{"location":"setup/deployment/#database","title":"Database","text":"<ul> <li>MySQL 8.0+ containing your person records</li> <li>Read-only access</li> <li>Required fields:<ul> <li>A unique identifier</li> <li>Full name</li> <li>Date of birth</li> </ul> </li> </ul>"},{"location":"setup/deployment/#container-images","title":"Container Images","text":"<p>Tetra Connect is distributed as container images via GitHub Container Registry (GHCR)</p>"},{"location":"setup/deployment/#getting-access","title":"Getting Access","text":"<p>Tetra Technology will provide you with the necessary credentials to access the Tetra Connect GHCR. Contact:</p> <ul> <li>Email: support@tetratechnology.co.uk</li> <li>Packages: https://github.com/orgs/tetra-connect-releases/packages</li> </ul> <p>You will receive:</p> <ul> <li>Registry username</li> <li>Personal Access Token (PAT) for authentication</li> </ul>"},{"location":"setup/deployment/#available-images","title":"Available Images","text":"Service Image Architecture Search Service <code>ghcr.io/tetra-connect-releases/search-service</code> amd64 / arm64 Score Service <code>ghcr.io/tetra-connect-releases/score-service</code> amd64 / arm64 Ingestion Service <code>ghcr.io/tetra-connect-releases/ingestion-service</code> amd64 / arm64 UI <code>ghcr.io/tetra-connect-releases/tetra-connect-ui</code> amd64 / arm64 <p>One Deployment per Data Source</p> <p>Each Tetra Connect deployment is configured for a single data source. If you have multiple databases or data sources, deploy separate instances of Tetra Connect for each. This provides isolation and allows you to independently configure and tune each deployment for its specific data source and use case.</p>"},{"location":"setup/deployment/#infrastructure-requirements","title":"Infrastructure Requirements","text":""},{"location":"setup/deployment/#database_1","title":"Database","text":"<p>Your existing database containing person records:</p> <ul> <li>Supported: MySQL 8.0+</li> <li>Access: Read-only access for Ingestion Service</li> <li>Network: Ingestion Service must be able to connect to the database</li> <li>Required Fields: External ID, Full Name, Date of Birth</li> </ul> <p>Schema Flexibility</p> <p>Tetra Connect adapts to your existing schema via configuration. No schema changes are required - you specify table and column names via environment variables.</p>"},{"location":"setup/deployment/#shared-storage_1","title":"Shared Storage","text":"<p>Ingestion Service writes indexes, Search Service reads them. Both must access the same storage location.</p> <p>Requirements</p> <ul> <li>Type: Shared filesystem (NFS, Amazon EFS, Azure Files, Google Filestore, etc.) Note that object stores like S3 are not supported.</li> <li>Access: Ingestion Service needs read/write, Search Service needs read-only</li> <li>Capacity: Approximately 1GB per 1M records (varies by data)</li> <li>Performance: Standard performance tier is typically sufficient</li> </ul>"},{"location":"setup/deployment/#resource-requirements","title":"Resource Requirements","text":"<p>Minimum per service</p> Service CPU (cores) Memory (GB) Storage Scaling Search Service 2 4 Shared (read-only) Horizontal Score Service 1 2 - Horizontal Ingestion Service 2 4 Shared (read/write) Single only UI 0.5 1 - Horizontal <p>Ingestion Service Scaling</p> <p>The Ingestion Service must run as a single instance to avoid write conflicts to the shared index storage. Do not scale horizontally.</p>"},{"location":"setup/deployment/#network-requirements","title":"Network Requirements","text":"<p>Inter-service communication</p> From Service To Service Port Protocol Search Service Score Service 1969 HTTP UI Search Service 1967 HTTP <p>External connectivity</p> Service Direction Purpose Ingestion Service Outbound Connect to your database Search Service Inbound API access for client applications Ingestion Service Inbound API access for triggering ingestion UI Inbound Web interface access (optional) <p>Default ports (configurable via <code>SERVER_PORT</code> environment variable)</p> Service Default Port Search Service 1967 Score Service 1969 Ingestion Service 1970 UI 1968"},{"location":"setup/deployment/#service-configuration","title":"Service Configuration","text":"<p>All services are configured via environment variables.</p> <p>Deployment Order</p> <p>Deploy services in this order to satisfy dependencies:</p> <ol> <li>Score Service - No dependencies, deploy first</li> <li>Search Service - Requires Score Service URL and shared storage</li> <li>Ingestion Service - Requires database and shared storage (independent of Search Service)</li> <li>UI - Requires both Search Service and Score Service URLs</li> </ol> <p>Parallel Deployment</p> <p>Search Service and Ingestion Service can be deployed in parallel since they don't depend on each other, as long as Score Service is already running.</p>"},{"location":"setup/deployment/#score-service","title":"Score Service","text":"<p>The scoring engine has no external dependencies.</p> <p>Environment Variables</p> Variable Required Description Example <code>SERVER_PORT</code> No HTTP port (default: 1969) <code>1969</code> <p>Resources</p> <ul> <li>CPU: 1-2 cores</li> <li>Memory: 2-4 GB</li> <li>Storage: None required</li> </ul> <p>Scaling: Horizontally scalable</p>"},{"location":"setup/deployment/#ingestion-service","title":"Ingestion Service","text":"<p>Reads from your database and builds searchable indexes.</p> <p>Environment Variables</p> Variable Required Description Example <code>TETRA_CONNECT_INDEX_DIRECTORY</code> Yes Path to shared index storage <code>/mnt/shared-storage</code> <code>SPRING_DATASOURCE_URL</code> Yes Database JDBC URL <code>jdbc:mysql://&lt;host&gt;:3306/&lt;db&gt;</code> <code>SPRING_DATASOURCE_USERNAME</code> Yes Database username <code>tetra_reader</code> <code>SPRING_DATASOURCE_PASSWORD</code> Yes Database password <code>&lt;your-password&gt;</code> <code>TETRA_CONNECT_DATASOURCE_TABLE_NAME</code> Yes Source table name <code>persons</code> <code>TETRA_CONNECT_DATASOURCE_COLUMN_NAMES_SOURCEUNIQUEID</code> Yes ID column name <code>person_id</code> <code>TETRA_CONNECT_DATASOURCE_COLUMN_NAMES_SOURCENAME</code> Yes Full name column <code>full_name</code> <code>TETRA_CONNECT_DATASOURCE_COLUMN_NAMES_SOURCEDOB</code> Yes Date of birth column <code>dob</code> <code>TETRA_CONNECT_INDEX_BATCH_SIZE</code> No Ingestion batch size <code>100000</code> <code>SERVER_PORT</code> No HTTP port (default: 1970) <code>1970</code> <p>Storage Mount</p> <ul> <li>Mount shared storage at the path specified in <code>TETRA_CONNECT_INDEX_DIRECTORY</code></li> <li>Access mode: Read/write</li> <li>IMPORTANT: Must be the same storage location as Search Service</li> </ul> <p>Resources</p> <ul> <li>CPU: 2-4 cores</li> <li>Memory: 4-8 GB</li> <li>Storage: Shared storage (read/write)</li> </ul> <p>Scaling: Single instance only (do not scale horizontally)</p> <p>Depends on: Database access, shared storage</p>"},{"location":"setup/deployment/#search-service","title":"Search Service","text":"<p>Executes searches across indexes and calls Score Service for ranking.</p> <p>Environment Variables</p> Variable Required Description Example <code>TETRA_CONNECT_INDEX_DIRECTORY</code> Yes Path to shared index storage <code>/mnt/shared-storage</code> <code>SCORE_SERVICE_URL</code> Yes Score Service URL <code>http://&lt;score-host&gt;:1969</code> <code>SERVER_PORT</code> No HTTP port (default: 1967) <code>1967</code> <p>Storage Mount</p> <ul> <li>Mount shared storage at the path specified in <code>TETRA_CONNECT_INDEX_DIRECTORY</code></li> <li>Access mode: Read-only</li> </ul> <p>Resources</p> <ul> <li>CPU: 2-4 cores</li> <li>Memory: 4-8 GB</li> <li>Storage: Shared storage (read-only)</li> </ul> <p>Scaling: Horizontally scalable</p> <p>Depends on: Score Service</p>"},{"location":"setup/deployment/#ui","title":"UI","text":"<p>Web interface for ad-hoc searches and testing.</p> <p>Environment Variables</p> Variable Required Description Example <code>TETRA_CONNECT_SEARCH_HOST</code> Yes Search Service URL <code>http://&lt;search-host&gt;:1967</code> <code>TETRA_CONNECT_SCORE_HOST</code> Yes Score Service URL <code>http://&lt;score-host&gt;:1969</code> <code>SERVER_PORT</code> No HTTP port (default: 1968) <code>1968</code> <p>Resources</p> <ul> <li>CPU: 0.5-1 cores</li> <li>Memory: 1-2 GB</li> <li>Storage: None required</li> </ul> <p>Scaling: Horizontally scalable</p> <p>Depends on: Search Service, Score Service</p>"},{"location":"setup/deployment/#performance-tuning","title":"Performance Tuning","text":""},{"location":"setup/deployment/#jvm-memory-configuration","title":"JVM Memory Configuration","text":"<p>All services use JVM heap size configuration via <code>JAVA_TOOL_OPTIONS</code> (optional but recommended for production).</p> <p>Sizing Guidelines</p> <ul> <li>Set heap to 50-75% of container memory limit</li> <li>Leave headroom for off-heap memory (direct buffers, metaspace)</li> <li>Monitor GC behavior and adjust accordingly</li> </ul> <p>Example Configurations</p> <pre><code># Search Service - 8GB container limit\nJAVA_TOOL_OPTIONS=\"-Xmx6G -Xms6G -XX:+UseG1GC\"\n\n# Ingestion Service - 16GB container limit\nJAVA_TOOL_OPTIONS=\"-Xmx12G -Xms12G -XX:+UseG1GC\"\n\n# Score Service - 3GB container limit\nJAVA_TOOL_OPTIONS=\"-Xmx2G -Xms2G -XX:+UseG1GC\"\n</code></pre> Advanced Resource Tuning <p>The following optional environment variables control resource usage and performance characteristics.</p> <p>Search Service</p> <pre><code># Thread pool sizing for parallel search execution\nTETRA_CONNECT_SEARCH_CORE_POOL_SIZE=4      # Core pool size (default: 4)\nTETRA_CONNECT_SEARCH_MAX_POOL_SIZE=8       # Maximum pool size (default: 8)\n</code></pre> <p>Ingestion Service</p> <pre><code># Indexing performance parameters\nTETRA_CONNECT_INDEX_BATCH_SIZE=100000      # Records per batch (default: 100000)\nTETRA_CONNECT_INDEX_MAX_MERGE_SIZE=15      # Max merge size in GB (default: 15)\nTETRA_CONNECT_INDEX_MERGE_SEGMENTS=20      # Segments to merge (default: 20)\nTETRA_CONNECT_INDEX_MEMORY_SIZE=1024       # Index buffer in MB (default: 1024)\nTETRA_CONNECT_INDEX_THREAD_POOL_SIZE=8     # Indexing threads (default: 8)\n</code></pre> <p>Adjust these values based on:</p> <ul> <li>Batch size: Larger batches = faster ingestion but more memory</li> <li>Thread pools: Match to available CPU cores</li> <li>Merge settings: Tune for dataset size and available disk I/O</li> </ul> <p>Search Behavior Configuration</p> <p>For configuration that affects search behavior and scoring (fuzzy matching, field weights, index refresh intervals, etc.), see Tuning Search and Scoring Behaviour.</p>"},{"location":"setup/deployment/#verify-deployment","title":"Verify Deployment","text":"<p>Once all services are deployed, verify they are running correctly.</p> <p>Check service health:</p> <pre><code>curl http://&lt;search-service-url&gt;/actuator/health\ncurl http://&lt;score-service-url&gt;/actuator/health\ncurl http://&lt;ingestion-service-url&gt;/actuator/health\ncurl http://&lt;ui-service-url&gt;/actuator/health\n</code></pre> <p>Expected response: <pre><code>{\n  \"status\": \"UP\"\n}\n</code></pre></p> <p>Once all services show <code>\"status\": \"UP\"</code>, your deployment is complete.</p>"},{"location":"setup/deployment/#next-steps","title":"Next Steps","text":"<p>Once deployment is complete:</p> <ul> <li>Set Up Operations: Operations Guide - Configure monitoring, health checks, and scaling</li> <li>Ingest Your Data: Data Ingestion Guide - Build searchable indexes from your database</li> <li>Configure Search Behaviour: Searching Guide - Tune fuzzy matching, scoring, and field weights</li> <li>Perform Searches: Search Guide - Test search functionality</li> <li>Integrate APIs: API Reference - Integrate with your applications</li> <li>Explore with the UI: UI Guide  - Use the UI for ad-hoc queries and tuning</li> </ul>"},{"location":"setup/integration/","title":"Integrating with Tetra Connect","text":"<p>This guide explains how to integrate Tetra Connect's Search Service into your Java application to perform person record searches.</p>"},{"location":"setup/integration/#overview","title":"Overview","text":"<p>Tetra Connect provides a REST API that accepts search requests and returns scored, ranked results. The API supports two response formats:</p> <ul> <li>Protocol Buffers (recommended) - Compact binary format for optimal performance</li> <li>JSON - Human-readable format for debugging and testing</li> </ul> <p>For Java applications, Tetra Connect provides pre-built Protocol Buffers model JARs that enable type-safe integration without manual parsing.</p>"},{"location":"setup/integration/#quick-start","title":"Quick Start","text":""},{"location":"setup/integration/#1-add-maven-dependency","title":"1. Add Maven Dependency","text":"<p>Add the Protocol Buffers model library to your project:</p> <p>Maven:</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;uk.co.tetra.connect&lt;/groupId&gt;\n    &lt;artifactId&gt;search-api-model&lt;/artifactId&gt;\n    &lt;version&gt;${tetra-connect.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Gradle:</p> <pre><code>dependencies {\n    implementation 'uk.co.tetra.connect:search-api-model:${tetraConnectVersion}'\n}\n</code></pre> <p>Accessing the JAR</p> <p>The Protocol Buffers model JAR is published to GitHub Packages. You'll need the same credentials provided for accessing container images. See the Deployment Guide for access details.</p>"},{"location":"setup/integration/#2-configure-mavengradle-repository","title":"2. Configure Maven/Gradle Repository","text":"<p>Add GitHub Packages as a repository:</p> <p>Maven (<code>pom.xml</code>):</p> <pre><code>&lt;repositories&gt;\n    &lt;repository&gt;\n        &lt;id&gt;github&lt;/id&gt;\n        &lt;url&gt;https://maven.pkg.github.com/tetra-connect-releases/*&lt;/url&gt;\n    &lt;/repository&gt;\n&lt;/repositories&gt;\n</code></pre> <p>Configure credentials in <code>~/.m2/settings.xml</code>:</p> <pre><code>&lt;servers&gt;\n    &lt;server&gt;\n        &lt;id&gt;github&lt;/id&gt;\n        &lt;username&gt;YOUR_GITHUB_USERNAME&lt;/username&gt;\n        &lt;password&gt;YOUR_GITHUB_PAT&lt;/password&gt;\n    &lt;/server&gt;\n&lt;/servers&gt;\n</code></pre> <p>Gradle (<code>build.gradle</code>):</p> <pre><code>repositories {\n    maven {\n        url = uri(\"https://maven.pkg.github.com/tetra-connect-releases/*\")\n        credentials {\n            username = project.findProperty(\"gpr.user\") ?: System.getenv(\"GITHUB_USERNAME\")\n            password = project.findProperty(\"gpr.key\") ?: System.getenv(\"GITHUB_TOKEN\")\n        }\n    }\n}\n</code></pre>"},{"location":"setup/integration/#spring-boot-integration-example","title":"Spring Boot Integration Example","text":""},{"location":"setup/integration/#configuration","title":"Configuration","text":"<p>Create a configuration class to set up the WebClient:</p> <pre><code>package com.example.config;\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.reactive.function.client.WebClient;\n\n@Configuration\npublic class TetraConnectConfig {\n\n    @Value(\"${tetra-connect.search.host}\")\n    private String searchHost;\n\n    @Bean\n    public WebClient tetraConnectWebClient() {\n        return WebClient.builder()\n                .baseUrl(searchHost)\n                .build();\n    }\n}\n</code></pre> <p>application.yml:</p> <pre><code>tetra-connect:\n  search:\n    host: http://search-service:1967\n</code></pre>"},{"location":"setup/integration/#search-client","title":"Search Client","text":"<p>Create a client class to interact with the Search Service:</p> <pre><code>package com.example.client;\n\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.http.MediaType;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.reactive.function.client.WebClient;\nimport uk.co.tetra.connect.proto.search.ProtoTetraConnectResult;\n\nimport java.math.BigDecimal;\nimport java.time.LocalDate;\nimport java.util.Optional;\n\n@Component\n@RequiredArgsConstructor\npublic class TetraConnectSearchClient {\n\n    private final WebClient tetraConnectWebClient;\n\n    public ProtoTetraConnectResult search(\n            String firstName,\n            String lastName,\n            LocalDate dob,\n            String middleNames,\n            Integer maxResults,\n            BigDecimal minimumScore) {\n\n        return tetraConnectWebClient\n                .get()\n                .uri(uriBuilder -&gt; uriBuilder\n                        .path(\"/api/search\")\n                        .queryParam(\"firstName\", firstName)\n                        .queryParam(\"lastName\", lastName)\n                        .queryParam(\"dob\", dob)\n                        .queryParamIfPresent(\"middleNames\",\n                            Optional.ofNullable(middleNames))\n                        .queryParamIfPresent(\"maxNoOfResults\",\n                            Optional.ofNullable(maxResults))\n                        .queryParamIfPresent(\"minimumResponseScore\",\n                            Optional.ofNullable(minimumScore))\n                        .build())\n                .accept(MediaType.APPLICATION_PROTOBUF)\n                .retrieve()\n                .bodyToMono(ProtoTetraConnectResult.class)\n                .block();\n    }\n}\n</code></pre>"},{"location":"setup/integration/#service-layer-example","title":"Service Layer Example","text":"<p>Use the client in your service:</p> <pre><code>package com.example.service;\n\nimport com.example.client.TetraConnectSearchClient;\nimport lombok.RequiredArgsConstructor;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Service;\nimport uk.co.tetra.connect.proto.search.ProtoSearchResult;\nimport uk.co.tetra.connect.proto.search.ProtoTetraConnectResult;\n\nimport java.math.BigDecimal;\nimport java.time.LocalDate;\nimport java.util.List;\n\n@Slf4j\n@Service\n@RequiredArgsConstructor\npublic class PersonMatchingService {\n\n    private final TetraConnectSearchClient searchClient;\n\n    public List&lt;ProtoSearchResult&gt; findMatches(\n            String firstName,\n            String lastName,\n            LocalDate dob) {\n\n        log.info(\"Searching for person: {} {} (DOB: {})\",\n            firstName, lastName, dob);\n\n        ProtoTetraConnectResult result = searchClient.search(\n                firstName,\n                lastName,\n                dob,\n                null,  // middleNames\n                10,    // maxResults\n                BigDecimal.valueOf(0.7)  // minimumScore\n        );\n\n        log.info(\"Found {} matches in {}ms\",\n            result.getNoOfResults(),\n            result.getTotalTimeInMillis());\n\n        return result.getSearchResultsList();\n    }\n}\n</code></pre>"},{"location":"setup/integration/#ingestion-service-integration","title":"Ingestion Service Integration","text":"<p>The Ingestion Service provides endpoints for triggering data refresh and sync operations. Unlike the Search Service, the Ingestion Service uses simple REST endpoints without Protocol Buffers.</p>"},{"location":"setup/integration/#triggering-full-refresh","title":"Triggering Full Refresh","text":"<p>Rebuild all indexes from your database:</p> <pre><code>@Service\n@RequiredArgsConstructor\npublic class IngestionService {\n\n    private final WebClient ingestionWebClient;\n\n    @Value(\"${tetra-connect.ingestion.host}\")\n    private String ingestionHost;\n\n    public void triggerFullRefresh() {\n        WebClient.create(ingestionHost)\n                .post()\n                .uri(\"/api/refresh\")\n                .retrieve()\n                .toBodilessEntity()\n                .block();\n\n        log.info(\"Full refresh triggered asynchronously\");\n    }\n}\n</code></pre> <p>Asynchronous Operation</p> <p>The <code>/api/refresh</code> endpoint returns immediately while ingestion runs in the background. Monitor the Ingestion Service logs to track progress.</p>"},{"location":"setup/integration/#syncing-specific-records","title":"Syncing Specific Records","text":"<p>Update specific records by their external IDs:</p> <pre><code>public void syncRecords(List&lt;String&gt; externalIds) {\n    WebClient.create(ingestionHost)\n            .post()\n            .uri(uriBuilder -&gt; uriBuilder\n                    .path(\"/api/sync\")\n                    .queryParam(\"externalIds\", String.join(\",\", externalIds))\n                    .build())\n            .retrieve()\n            .toBodilessEntity()\n            .block();\n\n    log.info(\"Synced {} records\", externalIds.size());\n}\n</code></pre> <p>Example usage:</p> <pre><code>// Sync multiple records\ningestionService.syncRecords(List.of(\"12345\", \"67890\", \"11111\"));\n</code></pre> <p>Synchronous Operation</p> <p>The <code>/api/sync</code> endpoint is synchronous and waits for the sync to complete before returning. Use this for small numbers of records.</p>"},{"location":"setup/integration/#checking-index-size","title":"Checking Index Size","text":"<p>Verify the number of indexed records:</p> <pre><code>public long getIndexSize() {\n    Long size = WebClient.create(ingestionHost)\n            .get()\n            .uri(\"/api/size\")\n            .retrieve()\n            .bodyToMono(Long.class)\n            .block();\n\n    log.info(\"Index contains {} records\", size);\n    return size;\n}\n</code></pre>"},{"location":"setup/integration/#configuration-example","title":"Configuration Example","text":"<p>Configure both Search and Ingestion Service endpoints:</p> <pre><code>tetra-connect:\n  search:\n    host: http://search-service:1967\n  ingestion:\n    host: http://ingestion-service:1970\n</code></pre>"},{"location":"setup/integration/#complete-integration-example","title":"Complete Integration Example","text":"<p>Combine search and ingestion in a service:</p> <pre><code>@Service\n@RequiredArgsConstructor\n@Slf4j\npublic class TetraConnectService {\n\n    private final TetraConnectSearchClient searchClient;\n\n    @Value(\"${tetra-connect.ingestion.host}\")\n    private String ingestionHost;\n\n    /**\n     * Trigger full data refresh\n     */\n    public void refreshData() {\n        WebClient.create(ingestionHost)\n                .post()\n                .uri(\"/api/refresh\")\n                .retrieve()\n                .toBodilessEntity()\n                .block();\n\n        log.info(\"Full refresh initiated\");\n    }\n\n    /**\n     * Sync specific records after updates\n     */\n    public void syncUpdatedRecords(List&lt;String&gt; externalIds) {\n        WebClient.create(ingestionHost)\n                .post()\n                .uri(uriBuilder -&gt; uriBuilder\n                        .path(\"/api/sync\")\n                        .queryParam(\"externalIds\", String.join(\",\", externalIds))\n                        .build())\n                .retrieve()\n                .toBodilessEntity()\n                .block();\n\n        log.info(\"Synced {} records: {}\", externalIds.size(), externalIds);\n    }\n\n    /**\n     * Search for matching persons\n     */\n    public List&lt;ProtoSearchResult&gt; searchPersons(\n            String firstName, String lastName, LocalDate dob) {\n\n        ProtoTetraConnectResult result = searchClient.search(\n                firstName, lastName, dob, null, 10, null);\n\n        return result.getSearchResultsList();\n    }\n\n    /**\n     * Get total indexed records\n     */\n    public long getIndexedRecordCount() {\n        return WebClient.create(ingestionHost)\n                .get()\n                .uri(\"/api/size\")\n                .retrieve()\n                .bodyToMono(Long.class)\n                .block();\n    }\n}\n</code></pre>"},{"location":"setup/integration/#rest-api-reference","title":"REST API Reference","text":"<p>For detailed API documentation including all endpoints, request/response formats, and examples, see:</p> <ul> <li>Search Service API Reference</li> <li>Ingestion Service API Reference</li> </ul>"},{"location":"setup/integration/#best-practices","title":"Best Practices","text":""},{"location":"setup/integration/#connection-pooling","title":"Connection Pooling","text":"<p>Configure connection pooling for optimal performance:</p> <pre><code>import io.netty.channel.ChannelOption;\nimport org.springframework.http.client.reactive.ReactorClientHttpConnector;\nimport reactor.netty.http.client.HttpClient;\nimport reactor.netty.resources.ConnectionProvider;\n\n@Bean\npublic WebClient tetraConnectWebClient() {\n    ConnectionProvider connectionProvider = ConnectionProvider.builder(\"tetra-connect\")\n            .maxConnections(100)\n            .pendingAcquireMaxCount(500)\n            .build();\n\n    HttpClient httpClient = HttpClient.create(connectionProvider)\n            .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 5000);\n\n    return WebClient.builder()\n            .baseUrl(searchHost)\n            .clientConnector(new ReactorClientHttpConnector(httpClient))\n            .build();\n}\n</code></pre>"},{"location":"setup/integration/#timeouts","title":"Timeouts","text":"<p>Set appropriate timeouts:</p> <pre><code>import reactor.core.publisher.Mono;\nimport java.time.Duration;\n\npublic ProtoTetraConnectResult search(...) {\n    return tetraConnectWebClient\n            .get()\n            .uri(...)\n            .retrieve()\n            .bodyToMono(ProtoTetraConnectResult.class)\n            .timeout(Duration.ofSeconds(10))  // 10 second timeout\n            .block();\n}\n</code></pre>"},{"location":"setup/integration/#retry-strategy","title":"Retry Strategy","text":"<p>Implement retry logic for transient failures:</p> <pre><code>import reactor.util.retry.Retry;\n\npublic ProtoTetraConnectResult search(...) {\n    return tetraConnectWebClient\n            .get()\n            .uri(...)\n            .retrieve()\n            .bodyToMono(ProtoTetraConnectResult.class)\n            .retryWhen(Retry.backoff(3, Duration.ofMillis(100))\n                .filter(throwable -&gt; throwable instanceof WebClientResponseException.ServiceUnavailable))\n            .block();\n}\n</code></pre>"},{"location":"setup/integration/#async-operations","title":"Async Operations","text":"<p>For non-blocking operations, work with <code>Mono</code> directly:</p> <pre><code>public Mono&lt;ProtoTetraConnectResult&gt; searchAsync(\n        String firstName, String lastName, LocalDate dob) {\n\n    return tetraConnectWebClient\n            .get()\n            .uri(uriBuilder -&gt; uriBuilder\n                    .path(\"/api/search\")\n                    .queryParam(\"firstName\", firstName)\n                    .queryParam(\"lastName\", lastName)\n                    .queryParam(\"dob\", dob)\n                    .build())\n            .accept(MediaType.APPLICATION_PROTOBUF)\n            .retrieve()\n            .bodyToMono(ProtoTetraConnectResult.class);\n}\n</code></pre>"},{"location":"setup/integration/#performance-considerations","title":"Performance Considerations","text":""},{"location":"setup/integration/#use-protocol-buffers","title":"Use Protocol Buffers","text":"<p>Protocol Buffers offer significantly better performance than JSON:</p> <ul> <li>Faster serialization/deserialization - Binary format is more efficient</li> <li>Smaller payload size - Reduces network bandwidth</li> <li>Type safety - Compile-time checking of message structure</li> </ul>"},{"location":"setup/integration/#limit-result-size","title":"Limit Result Size","text":"<p>Use <code>maxNoOfResults</code> to limit the number of results processed:</p> <pre><code>// Only return top 10 matches\nsearchClient.search(firstName, lastName, dob, null, 10, null);\n</code></pre>"},{"location":"setup/integration/#adjust-score-threshold","title":"Adjust Score Threshold","text":"<p>Use <code>minimumResponseScore</code> to filter low-quality matches early:</p> <pre><code>// Only return matches with score &gt;= 0.8\nsearchClient.search(firstName, lastName, dob, null, null,\n    BigDecimal.valueOf(0.8));\n</code></pre>"},{"location":"setup/integration/#next-steps","title":"Next Steps","text":"<ul> <li>Review the Search Guide for detailed information on search parameters and scoring configuration</li> <li>See the Search Service API Reference and Ingestion Service API Reference for complete API documentation</li> </ul>"}]}